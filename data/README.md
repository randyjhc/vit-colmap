# Data Directory Structure

This directory contains all data used by the vit-colmap pipeline, including input images, intermediate files, and reconstruction outputs.

## Directory Layout

```
data/
├── raw/              # Raw input datasets
├── intermediate/     # Intermediate processing files (databases, temp images)
└── outputs/          # Final reconstruction outputs
```

## Directory Descriptions

### `raw/` - Raw Input Datasets

Contains original, unprocessed datasets. Datasets should be organized by name:

```
raw/
├── DTU/                    # DTU MVS dataset
│   ├── Cleaned/           # Cleaned images by scan
│   │   ├── scan1/
│   │   ├── scan21/
│   │   └── ...
│   ├── SampleSet/
│   └── Points/
└── <your-dataset>/        # Your custom datasets
    └── images/
```

**Usage:**
- Place your image datasets here
- Keep original data structure intact
- Don't modify raw data - use symlinks or copies for processing

### `intermediate/` - Intermediate Files

Contains temporary files generated during pipeline execution:

```
intermediate/
└── <dataset-name>/
    ├── images/            # Symlinks or preprocessed images
    └── database.db        # COLMAP feature database (SQLite)
```

**Contents:**
- **`images/`**: Symlinked or preprocessed images ready for feature extraction
- **`database.db`**: COLMAP database containing:
  - Extracted features (keypoints and descriptors)
  - Feature matches between image pairs
  - Camera parameters

**Note:** These files can be safely deleted and regenerated by running the pipeline.

### `outputs/` - Reconstruction Outputs

Contains final 3D reconstruction results:

```
outputs/
└── <dataset-name>/
    └── sparse/
        ├── 0/                 # First reconstruction model
        │   ├── cameras.bin
        │   ├── images.bin
        │   └── points3D.bin
        └── 1/                 # Additional models (if multiple_models=True)
```

**Contents:**
- **`sparse/`**: Sparse 3D reconstruction in COLMAP format
  - **`cameras.bin`**: Camera intrinsic parameters
  - **`images.bin`**: Camera poses (extrinsics) for each image
  - **`points3D.bin`**: 3D point cloud with observations

**Visualization:**
```bash
# View reconstruction in COLMAP GUI
colmap gui --database_path data/intermediate/<dataset>/database.db \
           --image_path data/intermediate/<dataset>/images
```

## Example: Running DTU Dataset

### 1. Dataset Setup
```bash
# DTU dataset should be placed as:
data/raw/DTU/Cleaned/scan1/*.png
```

### 2. Run Pipeline
```bash
./scripts/run_DTU_colmap.sh scan1
```

### 3. Generated Files
```
data/
├── intermediate/DTU/scan1/
│   ├── images/              # Symlinks to diffuse lighting images
│   └── database.db          # Features and matches
└── outputs/DTU/scan1/
    └── sparse/
        └── 0/               # Reconstruction model
            ├── cameras.bin
            ├── images.bin
            └── points3D.bin
```

## Working with Your Own Data

### Directory Structure
```bash
# Create your dataset directory
mkdir -p data/raw/my-dataset/images

# Add your images
cp /path/to/images/*.jpg data/raw/my-dataset/images/
```

### Run Pipeline
```bash
# Using COLMAP SIFT (recommended)
python -m vit_colmap.pipeline.run_pipeline \
    --images data/raw/my-dataset/images \
    --output data/outputs/my-dataset \
    --db data/intermediate/my-dataset/database.db \
    --camera-model PINHOLE \
    --use-colmap-sift \
    --verbose
```

## See Also

- [COLMAP Documentation](https://colmap.github.io/)
- [DTU MVS Dataset](https://roboimagedata.compute.dtu.dk/)
- [Project Scripts](../scripts/)
